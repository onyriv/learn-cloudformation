# cfn-guard/rules.guard
# Baseline: every template must declare AWSTemplateFormatVersion and Description

rule template_has_version {
    AWSTemplateFormatVersion exists
}

rule template_has_description {
    Description exists
}

rule ec2_instance_type_restricted {
    Resources.*[ Type == "AWS::EC2::Instance" ] {
        Properties.InstanceType == "t2.micro"
    }
}